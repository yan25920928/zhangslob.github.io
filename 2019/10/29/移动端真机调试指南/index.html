<!doctype html>



  

<!-- Google AdSense start -->
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-9028627160282216",
    enable_page_level_ads: true
  });
</script>

<!-- Google AdSense end -->
<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="小歪的博客" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="1这是崔斯特的第九十八篇原创文章
各种抓包方法  (๑• . •๑)">
<meta property="og:type" content="article">
<meta property="og:title" content="移动端真机调试指南">
<meta property="og:url" content="https://zhangslob.github.io/2019/10/29/移动端真机调试指南/index.html">
<meta property="og:site_name" content="小歪的博客">
<meta property="og:description" content="1这是崔斯特的第九十八篇原创文章
各种抓包方法  (๑• . •๑)">
<meta property="og:image" content="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/MobileDebug_900x500.jpg">
<meta property="og:image" content="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Safari_WebInspector.jpg">
<meta property="og:image" content="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/iPhone_Safari.jpg">
<meta property="og:image" content="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Safari_Page.jpg">
<meta property="og:image" content="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Open_SafariDevTools.jpg">
<meta property="og:image" content="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Safari_DevTools.jpg">
<meta property="og:image" content="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Xcode_Simulator.jpg">
<meta property="og:image" content="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Xcode_Simulator_Version.jpg">
<meta property="og:image" content="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Android_USB_Debug.jpg">
<meta property="og:image" content="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Discover_USB_devices.jpg">
<meta property="og:image" content="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Android_Page.jpg">
<meta property="og:image" content="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Click_Inspect.jpg">
<meta property="og:image" content="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Chrome_DevTools.jpg">
<meta property="og:image" content="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/TBS_Studio.jpg">
<meta property="og:image" content="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Virtua_Android.jpg">
<meta property="og:image" content="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Local_IP.jpg">
<meta property="og:image" content="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Proxy_Port.jpg">
<meta property="og:image" content="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Set_HTTP_Proxy.jpg">
<meta property="og:image" content="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Allow_all_IP.jpg">
<meta property="og:image" content="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/All_IP.jpg">
<meta property="og:image" content="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Map_Local.jpg">
<meta property="og:image" content="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Charles_Throttling.jpg">
<meta property="og:image" content="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Install_SSL.jpg">
<meta property="og:image" content="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Save_SSL.jpg">
<meta property="og:image" content="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Android_Setup_SSL.jpg">
<meta property="og:image" content="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/iOS_Setup_SSL.jpg">
<meta property="og:image" content="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/SSL_Proxying_Settings.jpg">
<meta property="og:image" content="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Breakpoints.jpg">
<meta property="og:image" content="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Edit_Content.jpg">
<meta property="og:image" content="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Install_Weinre.jpg">
<meta property="og:image" content="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/run_weinre.jpg">
<meta property="og:image" content="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Target_Script.jpg">
<meta property="og:image" content="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Weinre_Remote.jpg">
<meta property="og:image" content="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Weinre_Element.jpg">
<meta property="og:image" content="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Charles_Rewrite.jpg">
<meta property="og:image" content="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Charles_Rewrite_Rule.jpg">
<meta property="og:updated_time" content="2019-10-29T02:17:04.154Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="移动端真机调试指南">
<meta name="twitter:description" content="1这是崔斯特的第九十八篇原创文章
各种抓包方法  (๑• . •๑)">
<meta name="twitter:image" content="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/MobileDebug_900x500.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 'undefined',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://zhangslob.github.io/2019/10/29/移动端真机调试指南/"/>





  <title> 移动端真机调试指南 | 小歪的博客 </title>
</head>



<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>
    <!-- <a href="https://github.com/zhangslob"><img style="position: absolute; top: 0; left: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_left_darkblue_121621.png" alt="Fork me on GitHub"></a> -->
    <a target="_blank" href="https://github.com/zhangslob"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/365986a132ccd6a44c23a9169022c0b5c890c387/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f7265645f6161303030302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"></a>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">小歪的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">人生苦短，我学Python</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocapitalize="off" autocomplete="off" autocorrect="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://zhangslob.github.io/2019/10/29/移动端真机调试指南/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="崔斯特">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://timgsa.baidu.com/timg?image&quality=80&size=b10000_10000&sec=1488291259&di=9b54b1ab9a4a02ec51e4344e960692d6&src=http://ni.ppsrc.com/aR24MryiGC7HFCEJTB-wgQ@640w_640h_75Q.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小歪的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                移动端真机调试指南
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-10-29T10:06:21+08:00">
                2019-10-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/抓包/" itemprop="url" rel="index">
                    <span itemprop="name">抓包</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><img src="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/MobileDebug_900x500.jpg" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">这是崔斯特的第九十八篇原创文章</div></pre></td></tr></table></figure>
<p>各种抓包方法  (๑• . •๑)</p>
<a id="more"></a>
<h1 id="系统自带调试功能"><a href="#系统自带调试功能" class="headerlink" title="系统自带调试功能"></a>系统自带调试功能</h1><h3 id="iOS-系统"><a href="#iOS-系统" class="headerlink" title="iOS 系统"></a>iOS 系统</h3><p><strong>运行环境要求</strong></p>
<ul>
<li>Mac + Safari 浏览器</li>
<li>iPhone（iOS 6 +） + Safari 浏览器</li>
</ul>
<p><strong>调试步骤</strong></p>
<p>1、使用 Lightning 数据线将 iPhone 与 Mac 相连</p>
<p>2、iPhone 开启 Web 检查器（设置 -&gt; Safari -&gt; 高级 -&gt; 开启 Web 检查器）</p>
<p><img src="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Safari_WebInspector.jpg" alt=""></p>
<p>3、iPhone 使用 Safari 浏览器打开要调试的页面</p>
<p><img src="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/iPhone_Safari.jpg" alt=""></p>
<p>4、Mac 打开 Safari 浏览器调试（菜单栏 —&gt; 开发 -&gt; iPhone 设备名 -&gt; 选择调试页面）</p>
<p><img src="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Safari_Page.jpg" alt=""></p>
<p>如果你的菜单栏没有“开发”选项，可以到左上角 <code>Safari</code> -&gt; <code>偏好设置</code> -&gt; <code>高级</code> -&gt; <code>在菜单栏中显示“开发”菜单</code>。</p>
<p><img src="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Open_SafariDevTools.jpg" alt=""></p>
<p>5、在弹出的 Safari Developer Tools 中调试</p>
<p><img src="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Safari_DevTools.jpg" alt=""></p>
<p>经过如上步骤就可在 Mac 端调试 iPhone 上 Safari 运行的页面了，但对于 WebView 页面就不适用了，另外 Windows 系统不适用此方案。</p>
<p><strong>当前测试环境：</strong></p>
<ul>
<li>Safari 版本 10.0.2</li>
<li>iPhone 7（iOS 10.1.1）</li>
</ul>
<p>没有 iPhone 设备可以在 App Store 安装 Xcode 使用其内置的 iOS 模拟器，安装完成后通过以下两种方式开启：</p>
<ul>
<li>右键 <code>Xcode 图标</code> -&gt; <code>Open Developer Tool</code> -&gt; <code>Simulator</code></li>
<li>右键 <code>Finder 图标</code> -&gt; <code>前往文件夹</code> -&gt; <code>/应用程序/Xcode.app/Contents/Developer/Applications/</code> -&gt; 运行 <code>Simulator.app</code></li>
</ul>
<p>运行 iOS 模拟器后，在模拟器中打开调试页面，再通过 Mac Safari 开发功能就可以调试到。</p>
<p><img src="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Xcode_Simulator.jpg" alt="Simulator"></p>
<p>如果我需要调试更低版本的 iOS 怎么办？实际使用的 iPhone 不可能去降版本，不必担心，Simulator 有。</p>
<p>点击左上角 <code>Xcode</code> -&gt; <code>Preferences</code> -&gt; <code>Downloads</code> 就可以看到提供了如下版本：</p>
<p><img src="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Xcode_Simulator_Version.jpg" alt="iOS 版本下载"></p>
<h1 id="Android-系统"><a href="#Android-系统" class="headerlink" title="Android 系统"></a>Android 系统</h1><h3 id="运行环境要求"><a href="#运行环境要求" class="headerlink" title="运行环境要求"></a>运行环境要求</h3><ul>
<li>Chrome 版本 &gt;= 32</li>
<li>Android 版本 4.0 +</li>
</ul>
<h3 id="调试步骤"><a href="#调试步骤" class="headerlink" title="调试步骤"></a>调试步骤</h3><ol>
<li><p>使用 USB 数据线将手机与电脑相连</p>
</li>
<li><p>手机进入开发者模式，勾选 USB 调试，并允许调试</p>
</li>
</ol>
<h3 id="如何开启-USB-调试："><a href="#如何开启-USB-调试：" class="headerlink" title="如何开启 USB 调试："></a>如何开启 USB 调试：</h3><p><strong>索尼 Z5：</strong><code>设置</code> -&gt; <code>关于关机</code> -&gt; <code>多次点击软件版本开启</code> -&gt; <code>返回上一级</code> -&gt; <code>开发者选项</code> -&gt; <code>USB 调试</code></p>
<p><strong>魅蓝 Note：</strong><code>设置</code> -&gt; <code>辅助功能</code> -&gt; <code>开发者选项</code> -&gt; <code>USB 调试</code></p>
<p>不同 Android 设备进入开发者模式的方式有稍稍不同，瞎捣鼓一下即可开启。</p>
<p><img src="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Android_USB_Debug.jpg" alt="开启 Android 调试"></p>
<ol>
<li>电脑打开 Chrome 浏览器，在地址栏输入：chrome://inspect/#devices 并勾选 Discover USB devices 选项</li>
</ol>
<p><img src="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Discover_USB_devices.jpg" alt="开启 Discover USB devices"></p>
<ol>
<li>手机允许远程调试，并访问调试页面</li>
</ol>
<p>官方的教程是想让你使用手机 Chrome 开启调试页面的，但实际需求更多的是调试一些 WebView 页面，在官方的 <a href="https://developers.google.com/web/tools/chrome-devtools/remote-debugging/webviews" target="_blank" rel="external">Remote Debugging WebViews</a> 有说明是可以调试 WebView 页面的，Android 版本需要在 4.4 以上，并且 APP 需要有配置相应的启动调试代码。</p>
<blockquote>
<p>WebView debugging must be enabled from within your application. To enable WebView debugging, call the static method setWebContentsDebuggingEnabled on the WebView class.</p>
<p>必须在 APP 内启动 WebView 调试。要启动 WebView 调试，需要调用 WebView 类上的静态方法 setWebContentsDebuggingEnabled。</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT) &#123;</div><div class="line">    WebView.setWebContentsDebuggingEnabled(<span class="literal">true</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>This setting applies to all of the application’s WebViews.</p>
<p>此设置适用于所有 APP 的 WebView。</p>
<p>Tip: WebView debugging is not affected by the state of the debuggable flag in the application’s manifest. If you want to enable WebView debugging only when debuggable is true, test the flag at runtime.</p>
<p>提示：WebView 是否可调试状态不受 mainfest 标志变量 debuggable 的影响，如果你想在 debuggable 为 true 的时候启动 WebView 调试，请使用以下代码：</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT) &#123;</div><div class="line">    <span class="keyword">if</span> (<span class="number">0</span> != (getApplicationInfo().flags &amp; ApplicationInfo.FLAG_DEBUGGABLE)) &#123; </div><div class="line">    	WebView.setWebContentsDebuggingEnabled(<span class="literal">true</span>); </div><div class="line">   	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img src="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Android_Page.jpg" alt="Android 打开调试页面"></p>
<ol>
<li>电脑点击 inspect 按钮</li>
</ol>
<p>如果你出现无法识别到设备的情况，建议尝试以下几种方法：</p>
<ul>
<li>使用原装数据线，不要使用山寨数据线或一线多头的数据线</li>
<li>重新插拔 USB 数据线，让手机处于充电状态</li>
<li>关闭电脑相关的应用助手</li>
<li>重启手机</li>
<li>Windows 系统下自动安装驱动失败，到 <a href="https://developer.android.com/studio/run/oem-usb.html#Drivers" target="_blank" rel="external">Android Studio</a> 手动下载</li>
</ul>
<p><img src="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Click_Inspect.jpg" alt="点击 inspect 按钮"></p>
<p>注意：使用 Chrome Inspect 查看页面时，Chrome 需要从 <a href="https://chrome-devtools-frontend.appspot.com/" target="_blank" rel="external">https://chrome-devtools-frontend.appspot.com</a> 加载资源，如果你得到的调试界面是一片空白，那你可能需要科学上网。</p>
<ol>
<li>进入调试界面</li>
</ol>
<p><img src="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Chrome_DevTools.jpg" alt="Chrome DevTools"></p>
<p><strong>当前测试环境：</strong></p>
<ul>
<li>Chrome 版本 55.0.2883.95</li>
<li>索尼 Z5（Android 5.1.1）</li>
<li>魅蓝 Note（Android 5.1）</li>
<li>三星 Galaxy S7（Android 6.0.1）</li>
</ul>
<p>这里顺带提一下 <a href="http://bbs.mb.qq.com/thread-1416936-1-1.html" target="_blank" rel="external">TBS Studio</a> 调试工具，它在 Chrome DevTools 调试功能的基础上进行了一些功能扩展，特性如下：</p>
<p>1.3 TBS Studio 功能特性</p>
<ol>
<li>自动检测手机与 PC 的连接；</li>
<li>自动检测网页是否可进行 Inspect 调试；</li>
<li>自动引导开发者打开 Inspector 调试开关；</li>
<li>一键开启 Inspector 调试，无需打开浏览器输入 URL，方便快捷；</li>
<li>扩展 X5 内核独有 Inspect 选项，方便页面分析和优化；</li>
<li>真机远程 Inspector 调试。</li>
</ol>
<p><img src="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/TBS_Studio.jpg" alt="TBS Studio"></p>
<p>详细介绍和使用步骤可到<a href="http://bbs.mb.qq.com/thread-1416936-1-1.html" target="_blank" rel="external">开发者论坛</a>查看，部分 Android 机型通过 USB 可能依旧无法识别到设备，可使用后面会讲到的其他方案。</p>
<p>关于 Android 虚拟机也是有的，这里推荐使用 <a href="https://www.genymotion.com/" target="_blank" rel="external">Genymotion</a> 软件，使用 Genymotion 前需要安装 <a href="https://www.virtualbox.org/wiki/Downloads" target="_blank" rel="external">VirtuaBox</a>，并且注册登陆后才能显示所有的虚拟设备。</p>
<p><img src="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Virtua_Android.jpg" alt="Genymotion"></p>
<h1 id="使用代理工具调试开发环境页面"><a href="#使用代理工具调试开发环境页面" class="headerlink" title="使用代理工具调试开发环境页面"></a>使用代理工具调试开发环境页面</h1><p>对于需要配 Hosts 才能访问的开发环境页面，手机在默认情况下是没有权限修改 Hosts 文件的，除非是 iOS 设备越狱后和 Android 设备 root 后，所以一般情况下手机是无法访问开发环境页面，这时需要使用到 Mac 系统的 <a href="https://www.charlesproxy.com/" target="_blank" rel="external">Charles</a> 代理工具，Windows 系统可使用 <a href="http://www.telerik.com/fiddler" target="_blank" rel="external">Fiddler</a> 代理工具。</p>
<h3 id="实现思路"><a href="#实现思路" class="headerlink" title="实现思路"></a>实现思路</h3><ul>
<li>Mac 作为代理服务器</li>
<li>手机通过 HTTP 代理连接到 Mac 电脑</li>
<li>手机上的请求都经过代理服务器</li>
<li>通过给 Mac 配 Hosts 实现目的</li>
</ul>
<h3 id="调试步骤-1"><a href="#调试步骤-1" class="headerlink" title="调试步骤"></a>调试步骤</h3><ol>
<li>查看电脑 IP（<code>菜单</code> -&gt; <code>Help</code> -&gt; <code>Local IP Addresses</code>）</li>
</ol>
<p><img src="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Local_IP.jpg" alt="本地 IP"></p>
<ol>
<li>查看端口（<code>菜单</code> -&gt; <code>Settings</code> -&gt; <code>Proxy Settings</code> -&gt; <code>Proxies</code>）</li>
</ol>
<p><img src="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Proxy_Port.jpg" alt="代理端口"></p>
<p>默认端口为：8888，勾选 <code>Enable transparent HTTP proxying</code></p>
<ol>
<li>将 IP、端口号填入手机 HTTP 代理</li>
</ol>
<p>iOS 系统：<code>设置</code> -&gt; <code>无线局域网</code> -&gt; <code>点击叹号</code> -&gt; <code>HTTP 代理</code> -&gt; <code>手动</code></p>
<p>Android 系统：<code>设置</code> -&gt; <code>长按当前网络</code> -&gt; <code>修改网络</code> -&gt; <code>高级选项</code> -&gt; <code>手动</code></p>
<p><img src="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Set_HTTP_Proxy.jpg" alt="手机设置代理"></p>
<ol>
<li>Charles 允许授权</li>
</ol>
<p><img src="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Allow_all_IP.jpg" alt="允许授权"></p>
<p>每次有新设备首次连接都会提示是否授权，可以通过 <code>Proxy</code> -&gt; <code>Access Control Settings</code> 配置以下参数 <code>0.0.0.0/0</code> 来关闭。</p>
<p><img src="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/All_IP.jpg" alt="所有 IP 通过"></p>
<ol>
<li><p>使用 SwitchHosts! 软件给 Mac 电脑配 Hosts</p>
</li>
<li><p>手机访问开发环境页面</p>
</li>
</ol>
<p>到这一步手机就可以访问到开发环境下的页面了，再结合前面所讲的方案来调试页面。</p>
<ol>
<li>Charles 的调试功能</li>
</ol>
<ul>
<li><strong>7.1 网络映射修改文件</strong></li>
</ul>
<p>除了结合前面的方案调试，可以使用 Map Local 网络映射功能来实现对文件的修改，在<code>菜单</code> -&gt; <code>Proxy</code> -&gt; <code>Start Recording</code> 开启抓包后访问页面，找到抓取到的样式文件，点击右键 <code>Map Local</code>，在 <code>Local path</code> 中设置本地映射文件的路径，修改后刷新页面可以看到效果。</p>
<p><img src="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Map_Local.jpg" alt="Map Local"></p>
<ul>
<li><strong>7.2 模拟网络速度</strong></li>
</ul>
<p><code>菜单</code> -&gt; <code>Proxy</code> -&gt; <code>Throttle Settings</code> -&gt; 勾选 <code>Enable Throttling</code>，在 <code>Throttling preset</code> 中可以选择需要模拟的网络速度。</p>
<p><img src="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Charles_Throttling.jpg" alt="模拟网络速度"></p>
<ul>
<li><strong>7.3 抓取 HTTPS 请求</strong></li>
</ul>
<p>默认情况下，Charles 无法抓取到 HTTPS 的请求，解决步骤如下：</p>
<p>Mac 端安装证书：<code>菜单</code> -&gt; <code>Help</code> -&gt; <code>SSL Proxying</code> -&gt; <code>Install Charles Root Certificate</code></p>
<p><img src="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Install_SSL.jpg" alt="Mac 安装 SSL"></p>
<p>然后导出 Charles SSL 证书安装到手机，<code>菜单</code> -&gt; <code>Help</code> -&gt; <code>SSL Proxying</code> -&gt; <code>Save Charles Root Certificate</code></p>
<p><img src="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Save_SSL.jpg" alt="导出 SSL"></p>
<p>Android 设备导出的 Charles SSL 证书存储到手机中并安装。</p>
<p><img src="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Android_Setup_SSL.jpg" alt="Android 安装 SSL"></p>
<p>iOS 设备用 Safari 打开 <a href="http://www.charlesproxy.com/getssl/" target="_blank" rel="external">http://www.charlesproxy.com/getssl/</a> 页面，下载 Charles SSL 证书并安装。</p>
<p><img src="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/iOS_Setup_SSL.jpg" alt="iOS 安装 SSL"></p>
<p>证书安装完成后，还需要给 Charles SSL 代理配置域名和端口号，<code>菜单</code> -&gt; <code>Proxy</code> -&gt; <code>SSL Proxying Settings</code> 勾选 <code>Enable SSL Proxying</code> 点击 <code>Add</code> 填入域名和端口号，经过以上步骤就可以抓取到 HTTPS 的请求了。</p>
<p><img src="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/SSL_Proxying_Settings.jpg" alt="设置 SSL 端口"></p>
<ul>
<li><strong>7.4 断点调试请求和响应内容</strong></li>
</ul>
<p>开启 Charles 断点 <code>Proxy</code> -&gt; <code>Breakpoints Settings</code> -&gt; <code>Enable Breakpoints</code>点击 <code>Add</code> 可设置断点条件或者单独对需要的文件右键 <code>Breakpoints</code> 设置断点。</p>
<p><img src="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Breakpoints.jpg" alt="开启断点"></p>
<p>访问页面后，即可编辑请求和响应的内容，点击 <code>Execute</code> 按钮完成。</p>
<p><img src="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Edit_Content.jpg" alt="编辑抓包内容"></p>
<h1 id="Weinre-调试工具"><a href="#Weinre-调试工具" class="headerlink" title="Weinre 调试工具"></a>Weinre 调试工具</h1><p>Weinre 是一款较老的远程调试工具，功能与 Chrome DevTools 相似，需要在页面中插入一段 JS 脚本来实时调试页面 DOM 结构、样式、JS 等，另外它使用的是代理的方式，所以兼容性很好，无论是新老设备系统通吃，但对于样式调试不友善，缺少断点调试及 Profiles 等常用功能。</p>
<p><strong>调试步骤：</strong></p>
<p><strong>1、安装 Weinre</strong></p>
<p>使用 NPM 全局安装 Weinre</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ sudo npm -g install weinre</div></pre></td></tr></table></figure>
<p><img src="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Install_Weinre.jpg" alt="安装 Weinre"></p>
<p><strong>2、启动 Weinre 监听服务</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ ipconfig getifaddr en0 // 查看本机 IP</div><div class="line">$ weinre --boundHost 10.14.217.14 --httpPort 8090</div></pre></td></tr></table></figure>
<p><code>--boundHost</code> 后填入你本机 IP 地址，<code>--httpPort</code> 后填入端口号，默认为 8080</p>
<p><img src="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/run_weinre.jpg" alt="启动监听"></p>
<p><strong>3、进入 Weinre 管理页面</strong></p>
<p>使用 Chrome 浏览器访问 <a href="http://10.14.217.14:8090/" target="_blank" rel="external">http://10.14.217.14:8090</a>，在管理页面你可以看到使用相关的说明，有进入客户端调试界面的地址、使用的文档、DEMO 页面等等，说明中要求将一段 JS 脚本 <code>&lt;script src=&quot;http://10.14.217.14:8090/target/target-script-min.js#anonymous&quot;&gt;&lt;/script&gt;</code> 插入到需要调试的页面中，插入代码后手机访问调试页面。</p>
<p><img src="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Target_Script.jpg" alt="需要插入的脚本"></p>
<p><strong>4、进入客户端调试界面</strong></p>
<p>点击 debug client user interface：<a href="http://10.14.217.14:8090/client/#anonymous" target="_blank" rel="external">http://10.14.217.14:8090/client/#anonymous</a> 的链接。</p>
<p><img src="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Weinre_Remote.jpg" alt="Weinre Remote"></p>
<p><img src="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Weinre_Element.jpg" alt="Weinre Element"></p>
<p><strong>5、JS 脚本注入</strong></p>
<p>手动加入 JS 脚本不优雅，这里可以结合我们前面提到的 Charles 代理工具实现动态 HTTP Script 注入。</p>
<p>打开<code>菜单</code> -&gt; <code>Rewrite</code> -&gt; 勾选 <code>Enable Rewrite</code></p>
<p><img src="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Charles_Rewrite.jpg" alt="Charles Rewrite"></p>
<p>输入 Rewrite 的名字并且在 Rules 一项添加匹配的规则，Location 一项是用于指定的域名和端口添加规则用的，这里我们不填默认匹配所有请求。</p>
<p>Type 允许对需要匹配的请求进行 Rewrite，一共提供了 11 种：</p>
<ul>
<li><code>Add Header</code></li>
<li><code>Modify Header</code></li>
<li><code>Remove Header</code></li>
<li><code>Host</code></li>
<li><code>Path</code></li>
<li><code>URL</code></li>
<li><code>Add Query Param</code></li>
<li><code>Modify Query Param</code></li>
<li><code>Remove Query Param</code></li>
<li><code>Response Status</code></li>
<li><code>Body</code></li>
</ul>
<p>这里我们需要使用到的是 <code>Body</code>，它的作用是对请求或响应内容进行匹配替换，按照下图的配置，通过将匹配到的响应内容 <code>&lt;/body&gt;</code> 标签替换成需要插入到页面中的 JS 脚本，从而实现动态插入。</p>
<p><img src="https://misc.aotu.io/ONE-SUNDAY/MobileDebug/Charles_Rewrite_Rule.jpg" alt="Rewrite Rule"></p>
<p>另外，也有基于 Weinre 进行功能扩展的工具，比如早期版本的 <a href="https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1455784140&amp;token=&amp;lang=zh_CN" target="_blank" rel="external">微信 Web 开发者工具 v0.7.0</a> 和 <a href="https://github.com/wuchangming/spy-debugger" target="_blank" rel="external">spy-debugger</a>，都在 Weinre 的基础上简化了要给每个调试页面添加 JS 脚本的步骤，spy-debugger 还增加了对 HTTPS 的支持。</p>
<hr>
<p>感谢你的阅读，如果你还有其他更为实用的调试方案，欢迎下方留言交流。</p>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="https://developer.apple.com/library/content/documentation/AppleApplications/Conceptual/Safari_Developer_Guide/GettingStarted/GettingStarted.html" target="_blank" rel="external">Safari Web Inspector Guide</a></li>
<li><a href="https://developers.google.com/web/tools/chrome-devtools/remote-debugging/" target="_blank" rel="external">Get Started with Remote Debugging Android Devices</a></li>
<li><a href="https://developers.google.com/web/tools/chrome-devtools/remote-debugging/webviews" target="_blank" rel="external">Remote Debugging WebViews</a></li>
<li><a href="http://people.apache.org/~pmuellr/weinre/docs/latest/Running.html" target="_blank" rel="external">weinre - Running</a></li>
<li><a href="https://www.charlesproxy.com/documentation/welcome/" target="_blank" rel="external">Charles Web Debugging Proxy</a></li>
<li><a href="https://github.com/wuchangming/spy-debugger" target="_blank" rel="external">wuchangming/spy-debugger</a></li>
<li><a href="http://bbs.mb.qq.com/thread-1416936-1-1.html" target="_blank" rel="external">TBS 开发调试利器 —— TBS Studio - QQ 浏览器移动产品论坛</a></li>
<li><a href="https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1455784140&amp;token=&amp;lang=zh_CN" target="_blank" rel="external">微信 web 开发者工具</a></li>
</ul>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>


    <footer class="post-footer">
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/09/25/Redis-SCAN的使用/" rel="next" title="Redis SCAN的使用">
                <i class="fa fa-chevron-left"></i> Redis SCAN的使用
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/11/04/Java基础知识/" rel="prev" title="Java基础知识">
                Java基础知识 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>
  <!-- 下一行是要添加的代码 start  -->
  <!-- Link Gitalk 的支持文件  -->
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
    <script src="https://unpkg.com/gitalk@latest/dist/gitalk.min.js"></script> 
    <script src="/js/src/md5.min.js"></script>
    <div id="gitalk-container"></div>     <script type="text/javascript">
    var gitalk = new Gitalk({

    // gitalk的主要参数
        clientID: '5ec2f8855d35458a8251',
        clientSecret: 'bba153b77a0beb4c104a1eefc4132cf2b794f44f',
        repo: 'zhangslob.github.io',
        owner: 'zhangslob',
        admin: ['zhangslob'],
        id: md5(location.pathname),

    });
    gitalk.render('gitalk-container');
  </script> 
  <!-- Gitalk end -->
  <!-- 到一上行结束 end  -->
          
          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="gitalk-container"></div>
      <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
    
  </div>

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="https://timgsa.baidu.com/timg?image&quality=80&size=b10000_10000&sec=1488291259&di=9b54b1ab9a4a02ec51e4344e960692d6&src=http://ni.ppsrc.com/aR24MryiGC7HFCEJTB-wgQ@640w_640h_75Q.jpeg"
               alt="崔斯特" />
          <p class="site-author-name" itemprop="name">崔斯特</p>
           
              <p class="site-description motion-element" itemprop="description">数据采集、数据处理、机器学习。</p>
          
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">121</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">39</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">84</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/zhangslob" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="mailto:zhangslob@gmail.com" target="_blank" title="E-Mail">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  E-Mail
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/cuishite" target="_blank" title="知乎">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  知乎
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.quora.com/profile/Zhangslob" target="_blank" title="Quora">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  Quora
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#系统自带调试功能"><span class="nav-number">1.</span> <span class="nav-text">系统自带调试功能</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#iOS-系统"><span class="nav-number">1.0.1.</span> <span class="nav-text">iOS 系统</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Android-系统"><span class="nav-number">2.</span> <span class="nav-text">Android 系统</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#运行环境要求"><span class="nav-number">2.0.1.</span> <span class="nav-text">运行环境要求</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#调试步骤"><span class="nav-number">2.0.2.</span> <span class="nav-text">调试步骤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#如何开启-USB-调试："><span class="nav-number">2.0.3.</span> <span class="nav-text">如何开启 USB 调试：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#使用代理工具调试开发环境页面"><span class="nav-number">3.</span> <span class="nav-text">使用代理工具调试开发环境页面</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#实现思路"><span class="nav-number">3.0.1.</span> <span class="nav-text">实现思路</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#调试步骤-1"><span class="nav-number">3.0.2.</span> <span class="nav-text">调试步骤</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Weinre-调试工具"><span class="nav-number">4.</span> <span class="nav-text">Weinre 调试工具</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#参考资料"><span class="nav-number">4.0.1.</span> <span class="nav-text">参考资料</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

一共来了 <span id="busuanzi_value_site_pv"></span> 位朋友啦~
您是崔斯特的第<span id="busuanzi_value_site_uv"></span>个小伙伴(๑• . •๑)

<div class="copyright" >
  
  &copy;  2016 - 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">崔斯特</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>



<span id="busuanzi_container_site_pv">
    本站总访问量<span id="busuanzi_value_site_pv"></span>次
</span>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    
    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	





  





  





  



  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
      search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="local-search-pop-overlay">').css('overflow', 'hidden');
      $('.popup').toggle();
    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';
      $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = $( "entry", xmlResponse ).map(function() {
            return {
              title: $( "title", this ).text(),
              content: $("content",this).text(),
              url: $( "url" , this).text()
            };
          }).get();
          var $input = document.getElementById(search_id);
          var $resultContent = document.getElementById(content_id);
          $input.addEventListener('input', function(){
            var matchcounts = 0;
            var str='<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length > 1) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var content_index = [];
                var data_title = data.title.trim().toLowerCase();
                var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                var data_url = decodeURIComponent(data.url);
                var index_title = -1;
                var index_content = -1;
                var first_occur = -1;
                // only match artiles with not empty titles and contents
                if(data_title != '') {
                  keywords.forEach(function(keyword, i) {
                    index_title = data_title.indexOf(keyword);
                    index_content = data_content.indexOf(keyword);
                    if( index_title >= 0 || index_content >= 0 ){
                      isMatch = true;
                      if (i == 0) {
                        first_occur = index_content;
                      }
                    }

                  });
                }
                // show search results
                if (isMatch) {
                  matchcounts += 1;
                  str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                  var content = data.content.trim().replace(/<[^>]+>/g,"");
                  if (first_occur >= 0) {
                    // cut out 100 characters
                    var start = first_occur - 20;
                    var end = first_occur + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if(start == 0){
                      end = 50;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    var match_content = content.substring(start, end);
                    // highlight all keywords
                    keywords.forEach(function(keyword){
                      var regS = new RegExp(keyword, "gi");
                      match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                    });

                    str += "<p class=\"search-result\">" + match_content +"...</p>"
                  }
                  str += "</li>";
                }
              })};
            str += "</ul>";
            if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
            if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
            $resultContent.innerHTML = str;
          });
          proceedsearch();
        }
      });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>


  

  

  

  


  

<script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
